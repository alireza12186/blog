---
layout: post
title:  "نصب درایور وایرلس realtek در توزیع‌های مختلف لینوکس"
date:   2018-03-05 08:37:00
categories: لینوکس
tags: [وای‌فای, realtek, rtl8723be, درایور, وایرلس ]
---
من یک لپتاپ hp دارم که وقتی روی آن هر توزیعی از لینوکس را نصب می‌کنم با مشکل درایور وای‌فای روبرو می‌شوم. کارت شبکه وایرلس لپتاپ من realtek است. مدل 8723be . در نسخه‌های قدیمی‌تر توزیع‌های مختلف که وای‌فای به صورت کامل غیرفعال بود. در نسخه‌های جدیدتر هم وای‌فای فعال است و شبکه وایرلس را هم می‌شناسد ولی چون آنتن آن بسیار ضعیف است در نتیجه فقط به صورت نصفه و نیمه نزدیک‌ترین شبکه را می‌شناسد و به همین ضعف آنتن سرعت اینترنت هم در اکثر مواقع ضعیف است. برای حل این مشکل در مخازن دبیان درایور مخصوصی طراحی شده است که می‌توان با نصب آن مشکل را حل کرد ولی در اوبونتو و مانجارو که من نصب کرده‌ام درایور اختصاصی وجود ندارد. در نتیجه گیک‌های گیت‌هابی درایور مخصوصی را نوشته‌اند. 
اگر وای‌فای شما به شبکه وایرلس خودتان وصل می‌شود ولی آنتن آن ضعیف است و شبکه‌های دیگر را نمی‌شناسد قبل از نصب درایور گیت‌هابی اول این کاری که می‌گویم را انجام بدهید. این کار روی اوبونتو 18.04 جواب می‌دهد. 
یک ترمینال باز کنید و داخل آن بنویسید:
{% highlight css %}
sudo modprobe -r rtl8723be
sudo modprobe rtl8723be ant_sel=1
{% endhighlight %}

حالا  چک کنید ببینید شبکه‌های وایرلس اطراف شما را شناخت یا نه. اگر نشناخت در ترمینال بزنید:‌
{% highlight css %}
sudo modprobe rtl8723be ant_sel=2
{% endhighlight %}

دوباره چک کنید. به احتمال قوی یکی از این دو کد باید باعث شود که قدرت سیگنال وایرلس شما افزایش یابد و شبکه‌های دیگر اطراف را هم بتوانید ببینید. اگر موفق شدید شبکه‌های دیگر را ببینید به سراغ مرحله بعد می‌رویم. در این مرحله در ترمینال می‌نویسیم: 
{% highlight css %}
echo "options rtl8723be fwlps=N ips=N ant_sel=2" | sudo tee /etc/modprobe.d/rtl8723be.conf
sudo modprobe -r rtl8723be
sudo modprobe rtl8723be
{% endhighlight %}

کد بالا بستگی به این دارد که کدام یک از کدهای قبلی با ant_sel=2 یا ant_sel=1 جواب داده باشد. 

اگر با روش بالا مشکل حل شد که چه بهتر ولی اگر حل نشد باید از درایور گیت‌هابی استفاده کنیم. برای استفاده باید گیت روی توزیع شما نصب باشد. اگر نیست با این کد گیت را نصب کنید:
{% highlight css %}
sudo apt-get install build-essential git
{% endhighlight %}

دستور بالا برای اوبونتو است. برای توزیع‌های دیگر دستورهای دیگری لازم است. حالا باید درایور مربوطه را گیت کنید. 
{% highlight css %}
git clone https://github.com/lwfinger/rtlwifi_new/
{% endhighlight %}

حالا وارد دایرکتوری گیت شده می‌شویم.
{% highlight css %}
cd rtlwifi_new
{% endhighlight %}

و درایور مربوطه را بیلد می‌کنیم
{% highlight css %}
make
{% endhighlight %}

و در مرحله آخر آن را نصب می‌کنیم. 
{% highlight css %}
sudo make install
{% endhighlight %}

حالا درایور را آنلود و لود می‌کنیم:
{% highlight css %}
sudo modprobe -r rtl8723be
sudo modprobe rtl8723be
{% endhighlight %}

این کار به احتمال قریب به یقین درایور را نصب خواهد کرد. اگر یک درصد این اتفاق نیفتاد دوباره روش اول را امتحان کنید. 

با این درایور مشکل وایرلس و بلوتوث realtek حل می‌شود. در ضمن در تمام دستورهای بالا به جای مدل rtl8723be می‌توانید هر یک از مدلهای دیگر realtek را جایگزین کنید. 

**نکته**: هر بار کرنل لینوکس شما آپدیت شد باید دوباره درایور را بیلد کنید
{% highlight css %}
cd rtlwifi_new
make clean
git pull
make clean && make
sudo make install
sudo modprobe -r rtl8723be
sudo modprobe rtl8723be
{% endhighlight %}
